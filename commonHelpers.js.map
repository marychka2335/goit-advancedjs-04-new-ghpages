{"version":3,"file":"commonHelpers.js","sources":["../src/api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '39809199-e4207359de0c1fdcee2eb8a85';\n\nasync function fetchImages(query, page, perPage) {\n  const params = new URLSearchParams({\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n    query: query,\n  });\n\n  const response = await axios.get(`${BASE_URL}?key=${API_KEY}&${params}`);\n  return response.data;\n}\n\nexport { fetchImages };","import iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './api.js';\n\nconst searchForm = document.querySelector('.search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst gallery = document.querySelector('.gallery');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet simpleLightboxInstance;\nconst perPage = 40;\n\nloadMoreBtn.classList.add('is-hidden');\n\nsearchForm.addEventListener('submit', handleSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  currentPage = 1;\n  currentQuery = event.currentTarget.elements.searchQuery.value.trim();\n  gallery.innerHTML = '';\n  loadMoreBtn.classList.add('is-hidden');\n\n  if (currentQuery === '') {\n    iziToast.warning({\n      message: 'The search string cannot be empty. Please specify your search query.',\n      messageColor: 'white',\n      backgroundColor: 'navy',\n      timeout: 3000,\n      position: 'topLeft'\n  },)\n    return;\n  }\n\n  try {\n    const response = await fetchImages(currentQuery, currentPage, perPage);\n\nif(currentQuery === 0 || response.totalHits === 0) {\n    iziToast.warning({\n        message: 'Sorry, there are no images matching your search query. Please try again.',\n        messageColor: 'white',\n        backgroundColor: 'navy',\n        timeout: 3000,\n        position: 'topLeft'\n    },);\n      \n    } else {\n      gallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n      simpleLightboxInstance = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250,\n      }).refresh();\n      iziToast.info({message: `Hooray! We found ${response.totalHits} images.`,\n      messageColor: 'white',\n        backgroundColor: 'navy',\n        timeout: 3000,\n        position: 'topLeft'},);\n\n      if (response.totalHits > perPage) {\n        loadMoreBtn.classList.remove('is-hidden');\n      }\n    }\n  } catch (error) {\n    handleFetchError(error);\n  } finally {\n    searchForm.reset();\n  }\n}\n\nfunction createMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        id,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a class=\"gallery__link\" href=\"${largeImageURL}\">\n            <div class=\"gallery-item\" id=\"${id}\">\n              <img class=\"gallery-item__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n              <div class=\"info\">\n                <p class=\"info-item\"><b>Likes</b>${likes}</p>\n                <p class=\"info-item\"><b>Views</b>${views}</p>\n                <p class=\"info-item\"><b>Comments</b>${comments}</p>\n                <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n              </div>\n            </div>\n          </a>`;\n      }\n    )\n    .join('');\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  simpleLightboxInstance.destroy();\n\n  try {\n    const response = await fetchImages(currentQuery, currentPage, perPage);\n    gallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n    simpleLightboxInstance = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    }).refresh();\n\n    const totalDisplayedImages =\n      gallery.querySelectorAll('.gallery__link').length;\n    const totalPages = Math.ceil(response.totalHits / 40);\n\n    if (totalDisplayedImages < response.totalHits) {\n      loadMoreBtn.disabled = false;\n      scrollToNextGalleryPage();\n    } else {\n      loadMoreBtn.classList.add('is-hidden');\n      iziToast.warning({\n        message: 'We are sorry, but you have reached the end of search results.',\n        messageColor: 'white',\n        backgroundColor: 'navy',\n        timeout: 3000,\n        position: 'bottomLeft'}, );\n    }\n  } \n\n  catch (onError) {\n   }\n}\n\nconst scrollToNextGalleryPage = () => {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n};"],"names":["BASE_URL","API_KEY","fetchImages","query","page","perPage","params","axios","searchForm","loadMoreBtn","gallery","currentQuery","currentPage","simpleLightboxInstance","handleSubmit","handleLoadMore","event","iziToast","response","createMarkup","SimpleLightbox","error","images","webformatURL","id","largeImageURL","tags","likes","views","comments","downloads","totalDisplayedImages","totalPages","scrollToNextGalleryPage","cardHeight"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAEhB,eAAeC,EAAYC,EAAOC,EAAMC,EAAS,CAC/C,MAAMC,EAAS,IAAI,gBAAgB,CACjC,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,EACV,MAAOF,CACX,CAAG,EAGD,OADiB,MAAMI,EAAM,IAAI,GAAGP,SAAgBC,KAAWK,GAAQ,GACvD,IAClB,CCXA,MAAME,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAU,SAAS,cAAc,UAAU,EAEjD,IAAIC,EAAe,GACfC,EAAc,EACdC,EACJ,MAAMR,EAAU,GAEhBI,EAAY,UAAU,IAAI,WAAW,EAErCD,EAAW,iBAAiB,SAAUM,CAAY,EAClDL,EAAY,iBAAiB,QAASM,CAAc,EAEpD,eAAeD,EAAaE,EAAO,CAOjC,GANAA,EAAM,eAAc,EACpBJ,EAAc,EACdD,EAAeK,EAAM,cAAc,SAAS,YAAY,MAAM,OAC9DN,EAAQ,UAAY,GACpBD,EAAY,UAAU,IAAI,WAAW,EAEjCE,IAAiB,GAAI,CACvBM,EAAS,QAAQ,CACf,QAAS,uEACT,aAAc,QACd,gBAAiB,OACjB,QAAS,IACT,SAAU,SAChB,CAAK,EACD,MACD,CAED,GAAI,CACF,MAAMC,EAAW,MAAMhB,EAAYS,EAAcC,EAAaP,CAAO,EAEtEM,IAAiB,GAAKO,EAAS,YAAc,EAC5CD,EAAS,QAAQ,CACb,QAAS,2EACT,aAAc,QACd,gBAAiB,OACjB,QAAS,IACT,SAAU,SAClB,IAGMP,EAAQ,mBAAmB,YAAaS,EAAaD,EAAS,IAAI,CAAC,EACnEL,EAAyB,IAAIO,EAAe,aAAc,CACxD,SAAU,GACV,aAAc,MACd,gBAAiB,SACjB,aAAc,GACtB,CAAO,EAAE,QAAO,EACVH,EAAS,KAAK,CAAC,QAAS,oBAAoBC,EAAS,oBACrD,aAAc,QACZ,gBAAiB,OACjB,QAAS,IACT,SAAU,SAAS,GAEjBA,EAAS,UAAYb,GACvBI,EAAY,UAAU,OAAO,WAAW,EAG7C,OAAQY,EAAP,CACA,iBAAiBA,CAAK,CAC1B,QAAY,CACRb,EAAW,MAAK,CACjB,CACH,CAEA,SAASW,EAAaG,EAAQ,CAC5B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,GAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe,kCAAkCL;AAAA,4CACLD;AAAA,oDACQD,WAAsBG;AAAA;AAAA,mDAEvBC;AAAA,mDACAC;AAAA,sDACGC;AAAA,uDACCC;AAAA;AAAA;AAAA,eAKlD,EACA,KAAK,EAAE,CACZ,CAEA,eAAef,GAAiB,CAC9BH,GAAe,EACfC,EAAuB,QAAO,EAE9B,GAAI,CACF,MAAMK,EAAW,MAAMhB,EAAYS,EAAcC,EAAaP,CAAO,EACrEK,EAAQ,mBAAmB,YAAaS,EAAaD,EAAS,IAAI,CAAC,EACnEL,EAAyB,IAAIO,EAAe,aAAc,CACxD,SAAU,GACV,aAAc,MACd,gBAAiB,SACjB,aAAc,GACpB,CAAK,EAAE,QAAO,EAEV,MAAMW,EACJrB,EAAQ,iBAAiB,gBAAgB,EAAE,OACvCsB,EAAa,KAAK,KAAKd,EAAS,UAAY,EAAE,EAEhDa,EAAuBb,EAAS,WAClCT,EAAY,SAAW,GACvBwB,MAEAxB,EAAY,UAAU,IAAI,WAAW,EACrCQ,EAAS,QAAQ,CACf,QAAS,gEACT,aAAc,QACd,gBAAiB,OACjB,QAAS,IACT,SAAU,YAAY,GAE3B,MAED,CACE,CACJ,CAEA,MAAMgB,EAA0B,IAAM,CACpC,KAAM,CAAE,OAAQC,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}